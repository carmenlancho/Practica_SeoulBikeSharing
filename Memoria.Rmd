---
title: "Seoul Bike Sharing"
author: "Isaac y Carmen"
date: "`r Sys.Date()`"
output: 
  html_document:
    theme: flatly
    toc: yes
    toc_float:
      collapsed: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introducción

El conjunto de datos contiene el recuento de bicicletas públicas alquiladas por hora en el sistema de bicicletas compartidas de Seúl, con los correspondientes datos meteorológicos e información sobre vacaciones.

Los datos han sido extraídos del [repositorio UCI Machine Learning](https://archive.ics.uci.edu/dataset/560/seoul+bike+sharing+demand). Según la propia descripción del repositorio, actualmente se están introduciendo bicicletas de alquiler en muchas ciudades urbanas para mejorar la comodidad de la movilidad. En el sistema de alquiler, es importante que las bicicletas estén disponibles y accesibles al público en el momento adecuado, ya que así se reduce el tiempo de espera. El objetivo de este sistema es proporcionar a la ciudad de un suministro estable de bicicletas de alquiler y, por ello, es crucial predecir correctamente el número de bicicletas necesarias a cada hora para el suministro estable de bicicletas de alquiler. 
El conjunto de datos contiene información meteorológica (temperatura, humedad, velocidad del viento, visibilidad, punto de rocío, radiación solar, nevadas, precipitaciones), el número de bicicletas alquiladas por hora e información sobre la fecha. Además, no contiene valores missing o perdidos.

Según la descripción oficial de los datos, las variables que conforman el conjunto de datos son:

* Date: Fecha en formato year-month-day
* Rented Bike Count: Conteo de bicicletas alquiladas cada hora
* Hour: Hora del día
* Temperature: Temperatura en grados Celsius
* Humidity: Humedad en %
* Wind Speed: Velocidad del viento en m/s
* Visibility: Visibilidad 10m
* Dew point temperature: Temperatura del punto de condensación en grados Celsius
* Solar radiation: Radiación solar en MJ/m2
* Rainfall: Lluvia en mm (equivalente a l/m2)
* Snowfall: Nieve en cm
* Seasons: Winter, Spring, Summer, Autumn
* Holiday: Holiday/No holiday
* Functional Day: NoFunc (Non Functional Hours), Fun (Functional hours)


Nótese que el problema original es de regresión, es decir, la variable que se quiere predecir (número de bicicletas que se alquilan a la hora) es continua. Como para esta práctica estamos interesados en problemas de clasificación, tendremos que convertir dicho target continuo en un target binario. Así, la variable a predecir pasará de "número de biciletas que se alquilan por hora" a "la cantidad de bicicletas que se alquilan a la hora supera un determinado umbral". Nótese que la determinación de dicho umbral debe ir fijado por el cliente/interesado que solicita a un equipo de Ciencia de Datos la realización de este proyecto. Al no tener en este caso cliente dado el entorno educativo en el que se encuadra el proyecto, tendremos que determinar dicho umbral en función del comportamiento de dicha variable.

# Business understanding
Planteamos algunas preguntas sobre nuestros datos:

* ¿El clima influye en el alquiler de bicicletas?
* ¿Influye más la nieve o la lluvia?
* ¿Nieva mucho en Seúl?


# Data understanding

A continuación leemos los datos y ver el tipo de variables.


```{r lectura, warning=FALSE}
# lectura de datos en csv
SeoulBikeData <- read.csv("datos/SeoulBikeData.csv")
ntotal <- dim(SeoulBikeData)[1] # numero de observaciones
ptotal <- dim(SeoulBikeData)[2] # numero de columnas

```

Comprobamos que tenemos $n=$```r ntotal``` observaciones y $p=$```r ptotal``` variables en la base de datos.


Realizamos la división de nuestros datos en 3 muestras: entrenamiento, validación y test.

```{r particion}
# mediante una semilla conseguimos que el ejercicio sea reproducible
set.seed(1)

# creamos índices
indices <- 1:ntotal
ntrain <- ntotal * .5
ntest <- ntotal * .25
nval <- ntotal - (ntrain+ntest)
indices.train <- sample(indices, ntrain, replace = FALSE)
indices.test <- sample(indices[-indices.train],ntest,replace=FALSE)
indices.val <- indices[-c(indices.train,indices.test)]

# Usamos el 50% de la base de datos como conjunto de entrenamiento
# 25% para test
# 25% para validación
train  <- SeoulBikeData[indices.train, ]
test   <- SeoulBikeData[indices.test, ]
val   <- SeoulBikeData[indices.val, ]

```

Vamos a echarle un ojo a las variables:

```{r}
str(train)
```

# Análisis exploratorio de datos


